angular.module("myApp",["ngAnimate","ngTouch","ngResource","ngRoute","ngCookies","ui.router","ui.bootstrap","angular-loading-bar"]).controller("MainCtrl",["$scope","userService",function(t,s){t.message="Welcome to AngularJS!",t.users=[],t.loading=!1,t.error=null,t.loadUsers=function(){t.loading=!0,t.error=null,s.getUsers().then(function(e){t.users=Array.isArray(e)?e:[]}).catch(function(e){t.error="加载用户列表失败: "+e.message,t.users=[]}).finally(function(){t.loading=!1})},t.addUser=function(){var e={id:Date.now(),name:"New User "+(t.users.length+1),email:"user"+(t.users.length+1)+"@example.com"};s.createUser(e).then(function(e){Array.isArray(t.users)?t.users.push(e):t.users=[e]}).catch(function(e){t.error="创建用户失败: "+e.message})},t.deleteUser=function(s){Array.isArray(t.users)&&("number"==typeof s&&s<t.users.length?t.users.splice(s,1):t.users=t.users.filter(function(e,t){return e.id!==s&&t!==s}))},t.loadUsers()}]).config(["$routeProvider","$locationProvider","$httpProvider",function(e,t,s){e.when("/",{templateUrl:"views/home.html",controller:"MainCtrl"}).when("/users",{templateUrl:"views/home.html",controller:"MainCtrl"}).when("/users/add",{templateUrl:"views/user-add.html",controller:"MainCtrl"}).when("/users/roles",{templateUrl:"views/user-roles.html",controller:"MainCtrl"}).when("/settings/general",{templateUrl:"views/settings-general.html",controller:"MainCtrl"}).when("/settings/security",{templateUrl:"views/settings-security.html",controller:"MainCtrl"}).when("/settings/backup",{templateUrl:"views/settings-backup.html",controller:"MainCtrl"}).when("/statistics/overview",{templateUrl:"views/statistics-overview.html",controller:"MainCtrl"}).when("/statistics/reports",{templateUrl:"views/statistics-reports.html",controller:"MainCtrl"}).when("/statistics/analytics",{templateUrl:"views/statistics-analytics.html",controller:"MainCtrl"}).when("/help",{templateUrl:"views/help.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"}),t.html5Mode(!0),s.interceptors.push("cfpLoadingBar")}]).run(["$rootScope",function(e){e.$on("$routeChangeStart",function(){console.log("Route change started")}),e.$on("$routeChangeSuccess",function(){console.log("Route change successful")})}]),angular.module("myApp").controller("SidebarCtrl",["$scope","$location",function(t,s){t.openMenus={},t.toggleMenu=function(e){t.openMenus[e]=!t.openMenus[e]},t.isMenuOpen=function(e){return!!t.openMenus[e]},t.isMenuActive=function(e){var t=s.path();switch(e){case"user":return 0===t.indexOf("/users");case"system":return 0===t.indexOf("/settings");case"statistics":return 0===t.indexOf("/statistics");default:return!1}},t.isActive=function(e){return s.path()===e},t.$on("$routeChangeSuccess",function(){var e=s.path();0===e.indexOf("/users")?t.openMenus.user=!0:0===e.indexOf("/settings")?t.openMenus.system=!0:0===e.indexOf("/statistics")&&(t.openMenus.statistics=!0)});var e=s.path();0===e.indexOf("/users")?t.openMenus.user=!0:0===e.indexOf("/settings")?t.openMenus.system=!0:0===e.indexOf("/statistics")&&(t.openMenus.statistics=!0)}]);